---
title: "Homework 3"
output: html_document
---
```{r loadpackages, results = FALSE, message=FALSE}
library('tidyverse')
library('lme4')
library('factoextra')

```

# 1. Using Github

The repository can be accessed at https://ct18173.github.io/homework3/.

# 2. Stroop, Standing Up or Sitting Down

```{r loadingdata, results='hide'}

# Loading in the Stroop data.
stroopdata <- read.csv('stroop_standing_data.csv')

```

```{r datacleaning}
# I am cleaning the data by first removing the mistrials and then removing the practice phase trials. I am choosing to do this as the mistrial data will be incorrect and the practice trials are there to allow the participant to understand the task before the real trials begin.
stroopdataclean <- stroopdata %>% 
  select(subject, age, gender, condition, phase, trial, stimulus, congruency, rt, correct) %>%
  filter(correct != 999) %>% 
  filter(phase != 'practice') %>%
  filter(congruency != 'baseline') %>%
  mutate(rt = as.numeric(rt))

stroopdataclean$rt <- as.numeric(stroopdataclean$rt)

stroopnona <- drop_na(stroopdataclean)

stroopnona$subject <- factor(stroopnona$subject)
stroopnona$congruency <- factor(stroopnona$congruency)

groupstroop <- group_by(stroopnona, subject, congruency, phase)
summarisestroop <- summarise(groupstroop, mean_rt = mean(rt))

widestroopdata <- pivot_wider(summarisestroop, names_from = congruency, values_from = 'mean_rt')

stroopdatafinal <- mutate(widestroopdata, stroopeffect = incongruent-congruent)

stroopdatamodel <- lmer(stroopeffect ~ phase + (1|subject), stroopdatafinal)

stroopdataplot <- ggplot(stroopdatafinal, aes(phase, stroopeffect)) + geom_col()

ggplot(stroopdatafinal, aes(phase, stroopeffect, fill = factor(phase))) + geom_boxplot() + geom_jitter(alpha = 0.5)

```

```{r fitmodel}
 #not working yet

```

# 3. The Dimensions of Popular Music

```{r loadingmusicdata, results='hide'}

# Loading in the Stroop data.
spotifydata <- read.csv('spotify_cleaned.csv')

```

```{r PCA}

pcaspotifydata <- select(spotifydata, -X, -Track.Name, -Artist, -Streams, -time_signature)
pcaspotifydata2 <- prcomp(pcaspotifydata)
summary(pcaspotifydata2)

factoextra::fviz_eig(pcaspotifydata2)

fviz_pca_var(pcaspotifydata2)

cor(pcaspotifydata2)

pcaspotifydata3 <- prcomp(pcaspotifydata2, scale = TRUE)
summary(pcaspotifydata3)
factoextra::fviz_eig(pcaspotifydata3)
